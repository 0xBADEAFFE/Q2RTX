[[toc ]]

Variables
==========

Network
----------

All cvars below can be changed at runtime and will take effect immediately.

- `set net_ip ""` (string)  
Specifies network interface address server UDP socket should be bound to.
Empty string means listening on all interfaces.

- `set net_port 27910` (integer)  
Specifies UDP port number server should listen on.

- `set net_tcp_ip $net_ip` (string)  
Specifies network interface address server TCP socket should be bound to.
Empty string means listening on all interfaces.
This cvar mirrors `net_ip` unless manually overridden.

- `set net_tcp_port $net_port` (integer)  
Specifies TCP port number server should listen on.
This cvar mirrors `net_port` unless manually overridden.

- `set net_tcp_clientip ""` (string)  
Specifies network interface address server should use for outgoing TCP
connections (this includes MVD and anticheat connections).
Empty string means default network interface.

Misc
----------

- `set sv_iplimit 3` (integer)  
Maximum number of simultaneous connections allowed from
single IP address. Setting this variable to 0 disables the limit.

- `set sv_status_show 2` (integer)  
Specifies how the server should respond to status queries
over UDP datagrams and HTTP.
   - 0 - do not respond at all
   - 1 - respond with server info only
   - 2 - respond with server info and player list

- `set sv_status_limit 15` (integer)  
Maximum number of status queries per one second server should respond to.

- `set sv_badauth_time 1` (integer)  
Time, in seconds, for server to be unresponsive after an invalid
authentication attempt. This applies to rcon commands, as well as
authenticated connection requests.
    
- `set sv_password ""` (string)  
If not empty, allows only authenticated clients to connect.
Authenticated clients are allowed to occupy reserved slots, see below.
Clients set their passwords via `password` userinfo variable.

- `set sv_reserved_slots 0` (integer)  
Number of client slots to be occupied only by clients who
know `sv_reserved_password` or `sv_password`. Must be less than
`maxclients` value. If `sv_mvd_enable` is non-zero and `sv_reserved_slots`
is zero, `sv_reserved_slots` is automatically set to one to reserve a slot
for dummy MVD observer. NOTE: `sv_reserved_slots` value is subtracted from
`maxclients` value when displayed in server info!

- `set sv_reserved_password ""` (string)  
See above. If empty, no one is allowed to occupy reserved slot(s), except of
dummy MVD observer. Clients set their passwords via `password` userinfo variable.

- `set sv_lan_force_rate 0` (boolean)  
When enabled, do not enforce any rate limits for clients whose IP is from
private address space (127.x.x.x, 10.x.x.x, 192.168.x.x, 172.16.x.x).

- `set sv_ghostime 6` (float)  
Maximum time, in seconds, to keep clients which passed initial
challenge-response connection stage but not yet requested server data chunk.
This also applies to HTTP clients in request processing stage.
Helps to avoid attacks flooding server with zombie clients, combined
with `sv_iplimit` variable.

- `set sv_force_reconnect ""` (string)  
When set to address string, forces new clients to reconnect to this address
as an additional proxy protection measure. This reconnection process is FAST.

- `set sv_show_name_changes 0` (boolean)  
Broadcast player name changes to everyone.

- `set sv_uptime 0` (boolean)  
Display uptime in server info.


MVD server
----------

- `set sv_http_enable 0` (boolean)  
Enable HTTP connections used for serving MVD clients and answering
status queries in HTML format.

- `set sv_http_maxclients 4` (integer)  
Maximum number of HTTP clients. Can be changed at any time, setting this to
zero effectively disables new HTTP connections.

- `set sv_http_minclients 4` (integer)  
Maximum number of HTTP clients to be kept in the special pool of recently
used slots for faster access and avoiding memory fragmentation.

- `set sv_mvd_nogun 1` (boolean)  
Reduce bandwidth usage by filtering on-screen gun updates out of MVD stream.

- `set sv_mvd_noblend 0` (boolean)  
Reduce bandwidth usage by filtering on-screen blend effects out of MVD stream.

- `set sv_mvd_max_duration 0` (float)  
Maximum duration in minutes of the locally recorded MVD.
Setting this to zero disables the limit.

- `set sv_mvd_max_size 0` (float)  
Maximum size in KB of the locally recorded MVD.
Setting this to zero disables the limit.

- `set sv_mvd_max_levels 1` (integer)  
Maximum number of levels (map changes) locally recorded MVD may span.
Setting this to zero disables the limit.

- `set sv_mvd_auth ""` (string)  
If not empty, perform Basic HTTP authentication of MVD connections.
Value should have `user:pass` format.

- `set sv_mvd_enable 0` (boolean)  
Enable recording local MVDs and serving MVD clients over HTTP.

- `set sv_mvd_begincmd "wait 50; putaway; wait 10; help;"` (string)  
Issue this command on behaf of dummy MVD observer as soon as it
enters the game. Do any game mod dependant preparations here to make sure
MVD observer enters an appropriate spectator team, opens the scoreboard, etc.
Each `wait` cycle lasts 0.1 second here.

- `set sv_mvd_scorecmd "putaway; wait 10; help;"` (string)  
Issue this command on behaf of dummy MVD observer each time no layout
updates are detected for more than 9 seconds. Useful for reopening the
scoreboard if the game mod closes it for some reason.
Each `wait` cycle lasts 0.1 second here.


MVD client
----------

- `set mvd_timeout 120` (float)    
Specifies MVD connection timeout value, in seconds.

- `set mvd_wait_delay 20` (float)  
Time, in seconds, for MVD client to buffer data right after initial
connection. This effectively specifies MVD stream delay seen by observers.

- `set mvd_wait_percent 2` (float)  
Inuse percentage of the input buffer when MVD state machine transitions
into running state to prevent buffer overrun.

- `set mvd_default_map "q2dm1"` (string)  
Specifies default map used for the Waiting Room channel.

- `set mvd_chase_prefix "xv 0 yb -64"` (string)  
Specifies POV info string position on the screen. This should be a valid
fragment of the Quake 2 layout script.

- `set mvd_chase_msgs 0` (boolean)  
When enabled, observers in chasecam mode will receive messages routed to
the chase target, otherwise they will receive messages routed to the dummy
MVD client (which is normally in observer mode on the game server side).

Hacks
----------

- `set sv_oldgame_hack 0` (boolean)  
On Unix systems, enables ABI compatibility mode which allows loading of
game libraries built using ancient GCC versions. If you happen to run closed
source game mod and your server crashes while loading a map, try enabling
this variable.

- `set sv_bodyque_hack 0` (boolean)  
Attempts to prevent "flying bodies" effect introduced by some buggy
mods. This hack assumes the mod allocates certain range of entity
slots for "body queue" and disables client side interpolation of
those entities. Use this hack with caution as it may not be compatible
with all mods and causes slightly higher bandwidth usage.

- `set sv_strafejump_hack 1` (boolean)  
Enables FPS-independent strafe jumping mode for clients using R1Q2
and Q2PRO protocols.

- `set map_override 0` (boolean)
When enabled, each time server map is loaded, file `maps/<mapname>.ent`
is searched. If this file exists, then entity lump of the map being loaded
is replaced with the contents of this file. Use this feature _only_ if you
know what you are doing.

Commands
==========

- `stuff <userid> <text ...>`  
Stuff the given _text_ into command buffer of the client identified by _userid_.

- `stuffall <text ...>`  
Stuff the given _text_ into command buffers of all connected clients.

- `pickclient <address:port>`  
Send `passive_connect` packet to the client at specified _address_ and _port_.
This is useful if the server is behind NAT or firewall and can not accept remote
connections. Remote client must support passive connections (R1Q2 and Q2PRO
clients do), must be in passive connection mode and the specified _port_
must be reachable. See `passive` [[client#index3h1]] command for more details.

- `dumpents [/]<entname>`
Dumps entity lump of the current map into `maps/<entname>.ent`, which you can later
edit and use as `map_override` file (see above).

- `addban <address[/mask]> [comment ...]`
Adds specified address to the ban list. Specify _mask_ to ban entire subnetwork.
If specified, _comment_ will be printed to banned user(s) when they attempt to connect.

- `delban <address[/mask]|id|all>`
Deletes single matching address from the ban list. You can also specify
numeric ID of the address/mask pair to delete, or `all` to clear
the whole ban list.

- `listbans`
Enumerates all registered address/mask pairs in the ban list.

- `addstuffcmd <connect|begin> <command> [...]`
Adds command to be automatically stuffed to every client as they initially
connect or each time they enter new map.

- `delstuffcmd <connect|begin> <id|all>`
Deletes command identified by numeric ID from the specified list.
You can also specify `all` to clear the whole stuffcmd list.

- `liststuffcmds <connect|begin>`
Enumerates all registered commands in the specified stuffcmd list.

- `addfiltercmd <command> [ignore|print|stuff|kick] [comment ...]`
Prevents client command otherwise unknown to the server from being
interpreted by the game mod, and takes the specified action instead.
For _print_ and _stuff_ actions _comment_ argument is mandatory.
Default action is _ignore_. Commands are matched in a case-insensitive way.

- `delfiltercmd <id|cmd|all>`
Deletes command identified by numeric ID or by name from the list of
filtered commands. You can also specify `all` to clear the whole
filtercmd list.

- `listfiltercmds`
Enumerates all filtered commands along with appropriate actions and comments.

- `mvdplay [-hl:n:] <filename> [...]`  
Play the local MVD identified by _filename_.

- `mvdconnect [-hi:n:] [http://][user:pass@]<host>[:port][/resource]`  
Connect to the MVD resource identified by _URI_. If _resource_ part is given,
default port is 80. Otherwise, default port is 27910 and _streamID_ identifies
the live MVD stream on server.

- `mvdisconnect [chanid]`  
Disconnect the specified channel from the server. There is no need to
specify `chanid` if there is only one active channel.

- `mvdkill [chanid]`  
Kill the specified channel. There is no need to specify `chanid` if
there is only one active channel.

- `mvdspawn`  
Spawn MVD client instance, that is, Waiting Room channel.

- `mvdchannels`  
Display status of all MVD channels.

- `mvdstuff <text>`  
Stuff the specified text into command buffer of the dummy MVD observer.
Should be issued on _game_ server, not on MVD client.

Anticheat
==========

Q2PRO server supports r1ch.net anticheat server interface, which means it is
capable of serving clients supported by the proprietary client side anticheat
module (currently, these include Windows builds of R1Q2, EGL, AprQ2 and Q2PRO).

See this [thread](http://www.r1ch.net/forum/index.php?topic=944.0) on r1ch.net
forums for more information on how to setup your server to use anticheat
interface.

Q2PRO anticheat server interface is implemented on top of R1Q2 reference
implementation. All R1Q2 variables and commands related to anticheat are
supported, except of `sv_anticheat_nag_*`, `sv_anticheat_client_restrictions`
and `sv_anticheat_force_protocol35` variables.
